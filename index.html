<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Sheby.id</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="BSSN-NEW-LOGO.png">
</head>

<body>

  <div id="loading-container">

    <img id="cute-icon" src="BSSN-NEW-LOGO.png">

    <div class="sparkle"></div>
    <div class="sparkle2"></div>

    <h2 class="loading-text">Sheby Sedang Menyiapkan Dunia Aman...</h2>

    <div class="loading-bar">
      <div id="progress" class="loading-fill"></div>
    </div>

    <p class="small-info">Tunggu sebentar ya teman-teman ğŸ˜Š</p>

    <button id="start-btn">Mulai!</button>

  </div>

  <audio id="loading-voice" src="loading-voice.mp3"></audio>

  <canvas id="unity-canvas"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/convai-web-sdk/dist/convai-web-sdk.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/grpc-web"></script>
  <!-- PENTING! Loader Unity WAJIB muncul sebelum createUnityInstance -->
  <script src="Build/_sheby.loader.js"></script>
  <script src="ConvaiWebGLSDK.js"></script>

  <script>
  const audio = document.getElementById("loading-voice");
  const startBtn = document.getElementById("start-btn");
  const loadingContainer = document.getElementById("loading-container");
  const canvas = document.getElementById("unity-canvas");

  startBtn.addEventListener("click", function () {

    // Sembunyikan tombol
    startBtn.style.display = "none";

    // Play audio saat loading mulai
    audio.volume = 0.9;
    audio.play();

    const buildUrl = "Build";

    createUnityInstance(canvas, {
      dataUrl: buildUrl + "/_sheby.data",
      frameworkUrl: buildUrl + "/_sheby.framework.js",
      codeUrl: buildUrl + "/_sheby.wasm",
      streamingAssetsUrl: "StreamingAssets",
      companyName: "BSSN",
      productName: "Sheby Chat 3D AI",
      productVersion: "1.0",
    },
    (progress) => {
      document.getElementById("progress").style.width = (progress * 100) + "%";
    })
    .then(() => {

      // ğŸ”¥ Loading selesai â†’ Matikan suara
      audio.pause();
      audio.currentTime = 0;

      // ğŸ”¥ Sembunyikan loading & tampilkan game
      loadingContainer.style.display = "none";
      canvas.style.display = "block";

      // ğŸ”¥ Biar fullscreen
      canvas.style.width = "100vw";
      canvas.style.height = "100vh";

    });
  });
</script>

</body>
</html>
